new entry "Shout_WildShape_Combat_Myrmidon_Fire"
type "SpellData"
using "Shout_WildShape_Combat_Myrmidon_Fire"
data "SpellContainerID" "Shout_WildShape_BonusAction"
data "SpellProperties" "ApplyStatus(WILDSHAPE_MYRMIDON_FIRE_VFX,100,-1);IF(DruidLevelEqual(10)):ApplyStatus(WILDSHAPE_ELEMENTAL_FIRE_PLAYER,100,-1);IF(DruidLevelEqual(11)):ApplyStatus(WILDSHAPE_ELEMENTAL_FIRE_PLAYER_2,100,-1);IF(DruidLevelHigherOrEqualThan(12)):ApplyStatus(WILDSHAPE_ELEMENTAL_FIRE_PLAYER_3,100,-1)"
data "DisplayName" "7c9d1841-e3a6-45fd-a1fa-1cda01170a4a;1"
data "Description" "1e416864-745d-4502-8802-1c6cb6fbe8b4;1"
data "ExtraDescription" "3a82397f-cdd9-4078-bd1c-6caf5518b8bf;1"
data "ExtraDescriptionParams" "RegainHitPoints(90);RegainHitPoints(144)"

new entry "WILDSHAPE_ELEMENTAL_FIRE_PLAYER"
type "StatusData"
using "WILDSHAPE_MYRMIDON_FIRE_PLAYER"
data "DisplayName" "7c9d1841-e3a6-45fd-a1fa-1cda01170a4a;1"
data "Boosts" "Attribute(Floating);Resistance(Fire,Immune);ProficiencyBonus(Skill,Perception);GameplayLight(9,false,0.1); VoicebarkBlock();BlockSpellCast();UnlockSpell(Shout_WildShape_Dismiss);UnlockSpell(Shout_WildShape_Combat_Heal,AddChildren)"
data "Passives" "WildShapeSpeed15;Darkvision18;Ethereal;LargeElementalImmunities;FireElemental_FireShield"
data "TemplateID" "f672efa6-ed94-4f4d-b9cf-6d482ef87c4f"
data "Rules" "6abaafdd-bc24-40c6-b970-f11dc2834b72"

//TODO: should also work for all touch abilities
new entry "FireElemental_FireShield"
type "PassiveData"
data "DisplayName" "h967349e8g79acg4187gb87egaed902982c8a;1"
data "Description" "hb6cc3a06gbe30g4fc9gada9gc8d15a7d9f8e;1"
data "DescriptionParams" "DealDamage(1d10,Fire)"
data "Icon" "Spell_Evocation_FireShield_Warm"
data "StatsFunctorContext" "OnAttacked"
data "Conditions" "IsMeleeAttack() and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(PASSIVE_FIRE_SHIELD_WARM,100,0);ApplyStatus(SELF,PASSIVE_FIRE_SHIELD_WARM_ATTACKER,100,0);DealDamage(SWAP,1d10,Fire,Magical)"

// new entry "Interrupt_HellishRebuke_Myrmidon"
// type "InterruptData"
// using "Interrupt_HellishRebuke"
// data "Conditions" "IsAbleToReact(context.Observer) and Enemy(context.Source,context.Observer) and HasFunctor(StatsFunctorType.DealDamage) and IsHit() and not HasStatus('SILENCED',context.Source) and not AnyEntityIsItem() and HasLastAttackTriggered()"
// data "Properties" "UseSpell(SWAP,Target_HellishRebuke_Myrmidon,true,true,true)"
// data "Cost" "ReactionActionPoint:1"
// data "EnableCondition" "not HasAnyStatus({'SG_Polymorph','SG_Blinded'},{},{'WILDSHAPE_MYRMIDON_FIRE_PLAYER','WILDSHAPE_MYRMIDON_FIRE_PLAYER_12'}) or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
// data "EnableContext" "OnStatusApplied;OnStatusRemoved"

// new entry "Target_HellishRebuke_Myrmidon"
// type "SpellData"
// data "SpellType" "Target"
// using "Target_HellishRebuke"
// data "PrepareSound" "CrSpell_Prepare_Myrmidon_Fire"
// data "PrepareLoopSound" "CrSpell_Loop_Myrmidon_Fire_Stop"
// data "CastSound" "CrSpell_Cast_Myrmidon_Fire_HellishRebuke"
// data "SpellAnimation" "ba3b4c6e-3710-451e-9f37-321dd44ff71a,,;,,;ab7b6aac-b3c9-4918-8f17-f777a94dcb5e,,;57211a11-ed0b-46d7-9369-81df25a85df6,,;6a9a22dd-a109-4f13-92e3-ea90d86bcab9,,;,,;eadedcce-d01b-4fbb-a1ae-d218f13aa5d6,,;,,;,,"
// data "WeaponTypes" "Melee"
// data "SpellFlags" "IsSpell;HasHighGroundRangeExtension;HasSomaticComponent;HasVerbalComponent;RangeIgnoreVerticalThreshold;IsHarmful;Wildshape"
// data "CastEffect" "a77e5e95-04e7-431b-9fd6-e1296087d354"
// data "TargetEffect" ""
// data "HitEffect" "5acfc7a5-9fdb-471a-a2f5-5393500f4634"
// data "Sheathing" "DontChange"

new entry "WILDSHAPE_ELEMENTAL_FIRE_PLAYER_2"
type "StatusData"
using "WILDSHAPE_ELEMENTAL_FIRE_PLAYER"
data "TemplateID" "5d6ea3f0-6f15-4d05-bca9-c5c489e5d00e"

new entry "WILDSHAPE_ELEMENTAL_FIRE_PLAYER_3"
type "StatusData"
using "WILDSHAPE_ELEMENTAL_FIRE_PLAYER"
data "TemplateID" "0b5dd30b-5e54-41a0-a41e-5fa85f450777"

new entry "Fire_Elemental_Wildshape_1"
type "Character"
using "_Elemental"
data "Strength" "10"
data "Dexterity" "17"
data "Constitution" "16"
data "Armor" "10"
data "XPReward" "40806669-8c6b-4068-8bc4-07e4981bb020"
data "Weight" "0.01"
data "SpellCastingAbility" "Dexterity"
data "UnarmedAttackAbility" "Dexterity"
data "UnarmedRangedAttackAbility" "Dexterity"
data "Vitality" "102"

new entry "Fire_Elemental_Wildshape_2"
type "Character"
using "Fire_Elemental_Wildshape_1"
data "Vitality" "129"

new entry "Fire_Elemental_Wildshape_3"
type "Character"
using "Fire_Elemental_Wildshape_1"
data "Vitality" "156"

// Illumination. The elemental sheds bright light in a 30-foot radius and dim light in an additional 30 feet.
// Water Susceptibility. For every 5 feet the elemental moves in water, or for every gallon of water splashed on it, it takes 1 cold damage.

// - The elemental can move through a space as narrow as 1 inch wide without squeezing.
// - The elemental can enter a hostile creature's space and stop there. 

// Can only enter the same enemy once per turn
new entry "Target_Enter_Creature_Space_Elemental_Fire"
type "SpellData"
data "SpellType" "Target"
data "DisplayName" "cc328c0f-badf-44d4-b9f1-998c56c7feac;1"
data "Description" "1c91ebc4-7a02-4ac9-9f17-27256a557ce2;1"
data "DescriptionParams" "DealDamage(1d10,Fire);DealDamage(1d10,Fire)"
data "Icon" "Spell_Evocation_FlameStrike"
data "TargetRadius" "1.5"
data "SpellProperties" "ApplyStatus(CREATURE_SPACE_ELEMENTAL_FIRE,100,1)"
data "TooltipDamageList" "DealDamage(1d10,Fire)"
data "TooltipStatusApply" "ApplyStatus(FIRE_ELEMENTAL_BURNING,100,-1)"
data "TargetConditions" "not Self() and not HasStatus('CREATURE_SPACE_ELEMENTAL_FIRE')"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "CycleConditions" "Enemy() and not Dead()"
data "UseCosts" ""
data "MaximumTargets" "1"
data "DamageType" "Fire"
data "VerbalIntent" "Damage"
data "SpellFlags" "IsMelee;IsHarmful"
data "SpellAnimation" "3ff87abf-1ea1-4c32-aadf-c822d74c7dc0,,;,,;ab7b6aac-b3c9-4918-8f17-f777a94dcb5e,,;57211a11-ed0b-46d7-9369-81df25a85df6,,;d8925ce4-d6d9-400c-92f5-ad772ef7f178,,;,,;eadedcce-d01b-4fbb-a1ae-d218f13aa5d6,,;,,;,,"
data "CastEffect" "488a0639-98c3-4c5f-83d2-3fe055f8e310"
data "TargetEffect" "f97febdd-7f77-4ca0-9a05-13e8bd5772e0"

new entry "CREATURE_SPACE_ELEMENTAL_FIRE"
type "StatusData"
data "StatusType" "BOOST"
data "OnApplyFunctors" "DealDamage(1d10,Fire,Magical);IF(not HasStatus('FIRE_ELEMENTAL_BURNING')):ApplyStatus(FIRE_ELEMENTAL_BURNING,100,-1)"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "Target_Touch_Elemental_Fire"
type "SpellData"
using "Target_Slam_Elemental_Earth"
data "DisplayName" "3ad066d7-cfd3-45dd-908d-327eca310d7c;1"
data "Description" ""
data "Icon" "Action_Monk_FangsOfTheFireSnake"
data "SpellProperties" ""
data "SpellSuccess" "ApplyStatus(FIRE_ELEMENTAL_BURNING,100,-1);DealDamage(2d6+UnarmedMeleeAbilityModifier,Fire,Magical)"
data "TooltipDamageList" "DealDamage(2d6+UnarmedMeleeAbilityModifier,Fire)"
data "TooltipStatusApply" "ApplyStatus(FIRE_ELEMENTAL_BURNING,100,-1)"
data "UseCosts" "ActionPoint:0.5"

new entry "Target_Multiattack_Elemental_Fire"
type "SpellData"
using "Target_Multiattack_Elemental_Fire"
data "SpellSuccess" "ApplyStatus(FIRE_ELEMENTAL_BURNING,100,-1);DealDamage(2d6+UnarmedMeleeAbilityModifier,Fire,Magical);Cast2[DealDamage(2d6+UnarmedMeleeAbilityModifier,Fire,Magical)]"
data "TargetConditions" "not Self() and not Dead()"
data "Description" "hd3a2350eg1045g4a32g9bd7g20b7dc0e927e;8"
data "ExtraDescription" ""
data "TooltipDamageList" "DealDamage(2d6+UnarmedMeleeAbilityModifier,Fire);DealDamage(2d6+UnarmedMeleeAbilityModifier,Fire)"
data "TooltipStatusApply" "ApplyStatus(FIRE_ELEMENTAL_BURNING,100,-1)"

// new entry "BURNING"
// type "StatusData"
// using "BURNING"
// data "OnRemoveFunctors" "RemoveStatus(FIRE_ELEMENTAL_BURNING)"

// TODO : remove this status when BURNING is removed
// Until a creature takes an action to douse the fire, the target takes 1d10 fire damage at the start of each of its turns.
// new entry "FIRE_ELEMENTAL_BURNING"
// type "StatusData"
// data "StatusType" "BOOST"
// data "DisplayName" "h978e1507gf90eg49b5ga5f8g5b1c0548d77f;1"
// data "Description" "h749103c1g241dg4d07g923eg977717a2d981;4"
// data "DescriptionParams" "DealDamage(1d6,Fire)"
// data "Icon" "Status_Burning"
// data "OnApplyFunctors" "ApplyStatus(BURNING,100,-1)"
// data "TickFunctors" "DealDamage(1d6,Fire)"
// data "TooltipDamage" "DealDamage(1d6,Fire)"

new entry "FIRE_ELEMENTAL_BURNING"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h978e1507gf90eg49b5ga5f8g5b1c0548d77f;1"
data "Description" "h749103c1g241dg4d07g923eg977717a2d981;4"
data "DescriptionParams" "DealDamage(1d10,Fire)"
data "Icon" "Status_Burning"
data "TickFunctors" "DealDamage(1d10,Fire)"
data "TooltipDamage" "DealDamage(1d10,Fire)"

// data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

// data "DescriptionParams" "DealDamage(1d10,Fire)"
// data "TooltipDamage" "DealDamage(1d10,Fire)"
//data "TickFunctors" "DealDamage(1d10,Fire)"
// data "TickFunctors" ""
