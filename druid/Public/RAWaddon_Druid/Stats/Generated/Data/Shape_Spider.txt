new entry "Shout_WildShape_Action_Spider"
type "SpellData"
using "Shout_WildShape_Spider"
data "SpellContainerID" "Shout_WildShape_Action"
data "SpellProperties" "IF(DruidLevelEqual(2)):ApplyStatus(WILDSHAPE_GIANT_WOLFSPIDER_PLAYER,100,-1);IF(DruidLevelEqual(3)):ApplyStatus(WILDSHAPE_GIANT_WOLFSPIDER_PLAYER_2,100,-1);IF(DruidLevelBetween(4,7)):ApplyStatus(WILDSHAPE_GIANT_WOLFSPIDER_PLAYER_3,100,-1);IF(DruidLevelHigherOrEqualThan(8)):ApplyStatus(WILDSHAPE_SPIDER_GIANT_PLAYER_3,100,-1)"
data "Description" "24703305-6666-450c-8aae-c2010f5199ea;1"
data "DescriptionParams" "11;18;44"

new entry "Shout_WildShape_Action_GiantSpider"
type "SpellData"
using "Shout_WildShape_Spider"
data "SpellContainerID" "Shout_WildShape_Action"
data "SpellProperties" "ApplyStatus(WILDSHAPE_SPIDER_GIANT_PLAYER_3,100,-1)"
data "DisplayName" "cfba11fa-4b2a-402e-b690-cf0176d460ff;1"
data "Description" "6d33b893-7c21-444b-805b-fb545110d364;1"
data "ExtraDescription" "3a82397f-cdd9-4078-bd1c-6caf5518b8bf;1"
data "ExtraDescriptionParams" "RegainHitPoints(26);RegainHitPoints(44)"

new entry "Shout_WildShape_BonusAction_GiantSpider"
type "SpellData"
using "Shout_WildShape_Action_GiantSpider"
data "SpellContainerID" "Shout_WildShape_BonusAction"
data "SpellProperties" "IF(DruidLevelEqual(2)):ApplyStatus(WILDSHAPE_SPIDER_GIANT_PLAYER,100,-1);IF(DruidLevelEqual(3)):ApplyStatus(WILDSHAPE_SPIDER_GIANT_PLAYER_2,100,-1);IF(DruidLevelHigherOrEqualThan(4)):ApplyStatus(WILDSHAPE_SPIDER_GIANT_PLAYER_3,100,-1)"
data "UseCosts" "BonusActionPoint:1;WildShape:1"

new entry "WILDSHAPE_SPIDER_GIANT_PLAYER"
type "StatusData"
using "WILDSHAPE_SPIDER_GIANT_PLAYER"
data "Boosts" "ProficiencyBonus(Skill,Perception);ProficiencyBonus(Skill,Stealth);ExpertiseBonus(Stealth); VoicebarkBlock();BlockSpellCast();UnlockSpell(Shout_WildShape_Dismiss);IF(isMoonDruid()):UnlockSpell(Shout_WildShape_Combat_Heal,AddChildren,d136c5d9-0ff0-43da-acce-a74a07f8d6bf)"
data "Passives" "WildShapeSpeed30;Darkvision60;SpiderWalk;SpiderFallResistance;Blindsight"
data "TemplateID" "b4060b81-6a24-4772-9eb5-514bce200eb8"

new entry "WILDSHAPE_SPIDER_GIANT_PLAYER_2"
type "StatusData"
using "WILDSHAPE_SPIDER_GIANT_PLAYER"
data "TemplateID" "5be755d2-da5a-4bec-afc0-17c86a35b23a"

new entry "WILDSHAPE_SPIDER_GIANT_PLAYER_3"
type "StatusData"
using "WILDSHAPE_SPIDER_GIANT_PLAYER"
data "TemplateID" "5addef55-a65f-4990-9a3d-db5fd04db664"

new entry "Giant_Spider_Wildshape_1"
type "Character"
using "Spider_Giant"
data "Vitality" "26"

new entry "Giant_Spider_Wildshape_2"
type "Character"
using "Giant_Spider_Wildshape_1"
data "Vitality" "35"

new entry "Giant_Spider_Wildshape_3"
type "Character"
using "Giant_Spider_Wildshape_1"
data "Vitality" "44"

new entry "Target_Bite_GiantSpider_Wildshape"
type "SpellData"
using "Target_Bite_GiantSpider_Wildshape"
data "Description" "9e05f433-2723-4009-b593-4dbca769ee95;1"
data "SpellSuccess" "IF(not HasPassive('PrimalStrike',context.Source)):DealDamage(max(1,1d8+UnarmedMeleeAbilityModifier),Piercing);IF(HasPassive('PrimalStrike',context.Source)):DealDamage(max(1,1d8+UnarmedMeleeAbilityModifier),Piercing,Magical);ApplyStatus(GIANT_SPIDER_POISON,100,1)"
data "TooltipDamageList" "DealDamage(1d8+UnarmedMeleeAbilityModifier,Piercing)"
data "TooltipStatusApply" "ApplyStatus(GIANT_SPIDER_POISON,100,1)"
data "TooltipAttackSave" "MeleeUnarmedAttack;Constitution"

// TODO: If the poison damage reduces the target to 0 hit points, the target is stable but poisoned for 1 hour, 
// even after regaining hit points, and is paralyzed while poisoned in this way.
new entry "GIANT_SPIDER_POISON"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "ba6fb6d5-b99f-46c0-b3c9-e5441983a96a;1"
data "Description" "b1c27a4d-1e6d-4a0f-932f-a2ebe683448f;1"
data "DescriptionParams" "DealDamage(2d8,Poison)"
data "TickType" "EndTurn"
data "TooltipSave" "Constitution"
data "TooltipDamage" "DealDamage(2d8,Poison)"
data "OnApplyRoll" "not SavingThrow(Ability.Constitution,WildShapeSaveDC(9))"
data "OnApplySuccess" "DealDamage(2d8,Poison)"
data "OnApplyFail" "DealDamage((2d8)/2,Poison)"

new entry "Target_Web_GiantSpider_WildShape"
type "SpellData"
using "Target_Web_Spider_WildShape"
data "Description" "9a28c372-4f27-42d8-92df-0e8f0b84bff9;1"
data "UseCosts" "ActionPoint:1"
data "SpellRoll" "Attack(AttackType.MeleeUnarmedAttack)"
data "SpellSuccess" "DealDamage(0,Piercing);IF(ProficiencyBonusEqual(2)):ApplyStatus(GIANT_SPIDER_WEB_DC12,100,10);IF(ProficiencyBonusEqual(3)):ApplyStatus(GIANT_SPIDER_WEB_DC13,100,10);IF(ProficiencyBonusEqual(4)):ApplyStatus(GIANT_SPIDER_WEB_DC14,100,10)"
data "TargetRadius" "9"
data "SpellProperties" ""
data "AreaRadius" ""
data "Requirements" ""
data "TooltipStatusApply" "ApplyStatus(GIANT_SPIDER_WEB_DC12,100,10)"

new entry "Target_Web_GiantSpider_WildShape_Disadvantage"
type "SpellData"
using "Target_Web_GiantSpider_WildShape"
data "DisplayName" "58c36b2f-6623-4d92-8e61-a2ebcdf63d3e;1"
data "SpellRoll" "Attack(AttackType.MeleeUnarmedAttack,false,true)"
data "TargetRadius" "18"

new entry "GIANT_SPIDER_WEB_DC12"
type "StatusData"
using "WEB"
data "Description" "h9bfc9679g3ed5g4449g8e08g479a50fc31be;4"
data "StackId" "WEB"
data "StackPriority" "0"
data "Boosts" "UnlockSpell(Shout_BurstWebbing_DC12);Advantage(AttackTarget);Disadvantage(AttackRoll);ActionResourceBlock(Movement);Disadvantage(SavingThrow,Dexterity);Attribute(Grounded)"
data "StatusGroups" "SG_Restrained"

new entry "GIANT_SPIDER_WEB_DC13"
type "StatusData"
using "GIANT_SPIDER_WEB_DC12"
data "Boosts" "UnlockSpell(Shout_BurstWebbing_DC13);Advantage(AttackTarget);Disadvantage(AttackRoll);ActionResourceBlock(Movement);Disadvantage(SavingThrow,Dexterity);Attribute(Grounded)"
data "StatusGroups" "SG_Restrained"

new entry "GIANT_SPIDER_WEB_DC14"
type "StatusData"
using "GIANT_SPIDER_WEB_DC12"
data "Boosts" "UnlockSpell(Shout_BurstWebbing_DC14);Advantage(AttackTarget);Disadvantage(AttackRoll);ActionResourceBlock(Movement);Disadvantage(SavingThrow,Dexterity);Attribute(Grounded)"
data "StatusGroups" "SG_Restrained"

// As an action, the restrained target can make a DC 12 Strength check, bursting the webbing on a success.
new entry "Shout_BurstWebbing_DC12"
type "SpellData"
data "SpellType" "Shout"
data "SpellProperties" "IF(SavingThrow(Ability.Strength,12)):RemoveStatus(GIANT_SPIDER_WEB_DC12)"
data "TargetConditions" "Self()"
// TODO: could probably find a better icon !
data "Icon" "PassiveFeature_Generic_Threat"
data "DisplayName" "0e850499-e22a-497f-bd7a-f7ea0b63fc71;1"
data "Description" "e5eac417-aff7-4a7e-a88b-744228693a0d;1"
data "DescriptionParams" "12"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "dd86aa43-8189-4d9f-9a5c-454b5fe4a197,,;,,;bcc3b0d9-f04f-4448-aab0-e0ad641167cc,,;bf924cc6-8b39-4c3b-b1c0-eda264cf6150,,;,,;,,;1715b877-4512-472e-9bd0-fd568a112e90,,;,,;,,"
data "VerbalIntent" "Utility"
data "Sheathing" "DontChange"
data "SpellFlags" "Temporary"

new entry "Shout_BurstWebbing_DC13"
type "SpellData"
using "Shout_BurstWebbing_DC12"
data "SpellProperties" "IF(SavingThrow(Ability.Strength,13)):RemoveStatus(GIANT_SPIDER_WEB_DC13)"
data "DescriptionParams" "13"

new entry "Shout_BurstWebbing_DC14"
type "SpellData"
using "Shout_BurstWebbing_DC12"
data "SpellProperties" "IF(SavingThrow(Ability.Strength,14)):RemoveStatus(GIANT_SPIDER_WEB_DC14)"
data "DescriptionParams" "14"

