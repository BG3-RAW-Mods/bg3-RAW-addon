new entry "Shout_WildShape_Combat_Myrmidon_Water"
type "SpellData"
using "Shout_WildShape_Combat_Myrmidon_Water"
data "SpellContainerID" "Shout_WildShape_BonusAction"
data "SpellProperties" "ApplyStatus(WILDSHAPE_MYRMIDON_WATER_VFX,100,-1);IF(DruidLevelEqual(10)):ApplyStatus(WILDSHAPE_ELEMENTAL_WATER_PLAYER,100,-1);IF(DruidLevelEqual(11)):ApplyStatus(WILDSHAPE_ELEMENTAL_WATER_PLAYER_2,100,-1);IF(DruidLevelHigherOrEqualThan(12)):ApplyStatus(WILDSHAPE_ELEMENTAL_WATER_PLAYER_3,100,-1)"
data "DisplayName" "7692e57d-8c38-4a8d-afe1-7465449aaf81;1"
data "Description" "143bef40-fece-42ba-88a3-939f60c1b00d;1"
data "ExtraDescription" "3a82397f-cdd9-4078-bd1c-6caf5518b8bf;1"
data "ExtraDescriptionParams" "RegainHitPoints(114);RegainHitPoints(168)"

new entry "WILDSHAPE_ELEMENTAL_WATER_PLAYER"
type "StatusData"
using "WILDSHAPE_MYRMIDON_WATER_PLAYER"
data "DisplayName" "7692e57d-8c38-4a8d-afe1-7465449aaf81;1"
data "Boosts" "Attribute(Floating);Resistance(Acid,Resistant);ProficiencyBonus(Skill,Perception); VoicebarkBlock();BlockSpellCast();UnlockSpell(Shout_WildShape_Dismiss);UnlockSpell(Shout_WildShape_Combat_Heal,AddChildren)"
data "Passives" "WildShapeSpeed9;Darkvision18;LargeElementalImmunities;WaterElementalWaterWalk"
data "TemplateID" "315643a1-5602-429e-af80-fbcdf616dd2f"
data "Rules" "6abaafdd-bc24-40c6-b970-f11dc2834b72"

new entry "WILDSHAPE_ELEMENTAL_WATER_PLAYER_2"
type "StatusData"
using "WILDSHAPE_ELEMENTAL_WATER_PLAYER"
data "TemplateID" "3f5c627e-36c1-44e0-a331-8f8bb1f277d1"

new entry "WILDSHAPE_ELEMENTAL_WATER_PLAYER_3"
type "StatusData"
using "WILDSHAPE_ELEMENTAL_WATER_PLAYER"
data "TemplateID" "f9abe558-2cde-4d66-8b8f-907679c3d63a"

new entry "Water_Elemental_Wildshape_1"
type "Character"
using "Water_Elemental"
data "Armor" "12"
data "SpellCastingAbility" "Strength"
data "UnarmedAttackAbility" "Strength"
data "UnarmedRangedAttackAbility" "Strength"
data "Weight" "0.01"
data "Vitality" "114"

new entry "Water_Elemental_Wildshape_2"
type "Character"
using "Water_Elemental_Wildshape_1"
data "Vitality" "141"

new entry "Water_Elemental_Wildshape_3"
type "Character"
using "Water_Elemental_Wildshape_1"
data "Vitality" "168"

// Water Form. The elemental can enter a hostile creature's space and stop there. It can move through a space as narrow as 1 inch wide without squeezing.
// Freeze. If the elemental takes cold damage, it partially freezes; its speed is reduced by 20 feet until the end of its next turn.

new entry "Target_Slam_Elemental_Water_Wildshape"
type "SpellData"
using "Target_Slam_Elemental_Water"
data "SpellSuccess" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning)"
data "TooltipDamageList" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning)"
data "UseCosts" "ActionPoint:0.5"
data "Description" ""
data "SpellProperties" ""
data "TooltipStatusApply" ""

new entry "Target_Multiattack_Elemental_Water_Wildshape"
type "SpellData"
using "Target_Multiattack_Elemental_Water"
data "SpellSuccess" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning);Cast2[DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning)]"
data "TooltipDamageList" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning);DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning)"
data "DamageType" "Bludgeoning"
data "Description" ""
data "ExtraDescription" ""

new entry "Target_Whelm_Elemental_Water"
type "SpellData"
data "SpellType" "Target"
data "DisplayName" "abff6b7c-0807-4ed7-85c0-ee9be7d7ced0;1"
data "Description" "b36d6782-ed55-424e-b33f-1c412313d461;1"
data "DescriptionParams" "DealDamage(2d8,Bludgeoning)"
data "Icon" "Action_Monster_ElementalWater_WintersBreath"
data "TargetRadius" "1.5"
data "SpellRoll" "not SavingThrow(Ability.Strength, WildShapeSaveDC(12))"
data "SpellSuccess" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning,Magical);IF(TargetSizeEqualOrSmaller(Size.Large)):ApplyStatus(ELEMENTAL_WATER_ATTEMPT_GRAPPLING,100,0)"
data "TooltipDamageList" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning)"
data "TargetConditions" "not Self() and not HasStatus('ELEMENTAL_WATER_GRAPPLED')"
data "RequirementConditions" "not HasStatusError('ELEMENTAL_WATER_GRAPPLING', 'CannotGrappleMoreThanOneTarget')"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "CycleConditions" "Enemy() and not Dead()"
data "UseCosts" "ActionPoint:1"
data "MaximumTargets" "1"
data "DamageType" "Bludgeoning"
data "VerbalIntent" "Damage"
data "SpellFlags" "IsMelee;IsHarmful"
data "SpellAnimation" "3ff87abf-1ea1-4c32-aadf-c822d74c7dc0,,;,,;463e2894-de95-4ad2-a991-a265e210af8c,,;b57f0afb-706f-4c04-9fb4-413a2a5baa8f,,;d8925ce4-d6d9-400c-92f5-ad772ef7f178,,;,,;eadedcce-d01b-4fbb-a1ae-d218f13aa5d6,,;,,;,,"
data "PrepareSound" "Spell_Prepare_Damage_GlyphofWardingCold_L5"
data "PrepareLoopSound" "Spell_Loop_Damage_GlyphofWardingCold_L5"
data "CastSound" "Spell_Cast_Damage_IceKnife_L1to3"
data "PrepareEffect" "VFX_Spells_Prepare_Damage_Cold_HandFX_Frost_Overlay_01:Dummy_R_HandFX;VFX_Spells_Prepare_Damage_Cold_HandFX_Frost_Overlay_02:Dummy_L_HandFX;VFX_Spells_Prepare_Arcane_Damage_Cold_R_HandFX_Textkey_01:Dummy_L_HandFX;VFX_Spells_Prepare_Arcane_Damage_Cold_R_HandFX_01:Dummy_R_HandFX"
data "CastEffect" "36718a29-73d8-457c-af7a-229c821bc1a2"
data "TargetEffect" "7d30207d-4c3f-4f01-8e50-aaff803e1992"
// Recharge doesn't work for players, disabled until it works:
// data "RechargeValues" "4-6"
// data "Cooldown" "OncePerShortRest"

new entry "ELEMENTAL_WATER_ATTEMPT_GRAPPLING"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "52b9be24-20ec-4a52-b09e-e25a377d795b;1"
data "OnApplyRoll" "not SavingThrow(Ability.Strength, WildShapeSaveDC(11))"
data "OnApplySuccess" "ApplyStatus(SELF,ELEMENTAL_WATER_GRAPPLING,100,-1);ApplyStatus(ELEMENTAL_WATER_GRAPPLED,100,-1)"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "ELEMENTAL_WATER_GRAPPLING"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "52b9be24-20ec-4a52-b09e-e25a377d795b;1"
data "Description" "501b83be-5a47-4d7d-8ab8-978d7fe77a92;1"
data "Icon" "Action_Monster_ElementalWater_WintersBreath"
data "AuraRadius" "2"
data "AuraStatuses" "TARGET:IF(HasStatus('ELEMENTAL_WATER_GRAPPLED',context.Target,context.Source)):ApplyStatus(ELEMENTAL_WATER_GRAPPLED_TECHNICAL)"
data "RemoveEvents" "OnStatusApplied;OnStatusRemoved;OnMove"
data "RemoveConditions" "HasAnyStatus({'SG_Incapacitated','SG_Stunned'})"

new entry "ELEMENTAL_WATER_GRAPPLING_TECHNICAL"
type "StatusData"
data "StatusType" "BOOST"
data "OnRemoveFunctors" "RemoveStatus(ELEMENTAL_WATER_GRAPPLING)"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "ELEMENTAL_WATER_GRAPPLED"
type "StatusData"
data "StatusType" "BOOST"
data "Icon" "Action_IntimidatingPresence"
data "DisplayName" "a4a2e41b-1ffd-4e19-91ad-2b8bae637cae;1"
data "Description" "8b069a3a-7984-466c-993d-2b52d66e9b6f;1"
data "DescriptionParams" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning)"
data "Boosts" "ActionResourceMultiplier(Movement,0,0);UnlockSpell(Target_BreakGrapple)"
data "AuraRadius" "2"
data "AuraStatuses" "TARGET:IF(HasStatus('ELEMENTAL_WATER_GRAPPLING')):ApplyStatus(ELEMENTAL_WATER_GRAPPLING_TECHNICAL)"
data "TickType" "StartTurn"
data "TickFunctors" "DealDamage(2d8+UnarmedMeleeAbilityModifier,Bludgeoning,Magical)"
data "RemoveEvents" "OnStatusApplied;OnStatusRemoved;OnMove"
data "RemoveConditions" "Tagged('GASEOUS_FORM') or Tagged('CANT_SHOVE_THROW')"
data "StatusGroups" "SG_Condition"
data "StillAnimationType" "Snared"

new entry "ELEMENTAL_WATER_GRAPPLED_TECHNICAL"
type "StatusData"
data "StatusType" "BOOST"
data "OnRemoveFunctors" "RemoveStatus(ELEMENTAL_WATER_GRAPPLED)"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "Target_BreakGrapple"
type "SpellData"
data "SpellType" "Target"
data "AIFlags" "CanNotUse"
data "TargetCeiling" "0"
data "TargetFloor" ".25"
data "TargetRadius" "2"
data "SpellRoll" "SavingThrow(Ability.Strength, 14)"
data "SpellSuccess" "RemoveStatus(SELF,ELEMENTAL_WATER_GRAPPLED);RemoveStatus(ELEMENTAL_WATER_GRAPPLING)"
data "TargetConditions" "HasStatus('ELEMENTAL_WATER_GRAPPLING',context.Target)"
data "Icon" "Action_Shove"
data "DisplayName" "0da0aa50-3b89-465f-86a3-49893564eddb;1"
data "Description" "f2c27330-4a62-445a-a4a6-3b8a77c2827e;1"
data "PrepareSound" "Generic_GeneralAction_Start"
data "PrepareLoopSound" "Generic_GeneralAction_Loop"
data "CastSound" "Action_Cast_Shove"
data "PreviewCursor" "Melee"
data "CastTextEvent" "Cast"
data "CycleConditions" "HasStatus('ELEMENTAL_WATER_GRAPPLING',context.Target)"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "0319ca29-4024-4649-9278-3c1f20c5f023,,;a71e11ca-95ab-463d-a4bf-fe8094126b61,,;352c3a89-f99c-4472-8424-58c0ffb15e55,,;a57fc614-ed20-4574-936b-bdcc6cebd36a,,;b24b3f23-6d3a-43ce-ae3a-abfb44d26082,,;200ab854-a989-4a6a-8ac9-4b20aecaccda,,;eadedcce-d01b-4fbb-a1ae-d218f13aa5d6,,;,,;,,"
data "VerbalIntent" "Utility"
data "SpellFlags" "IsMelee;Temporary"
data "HitAnimationType" "PhysicalDamage"
data "SpellAnimationIntentType" "Peaceful"
data "PrepareEffect" "c512042e-a04f-4a02-af7a-16f30e11ed95"
data "CastEffect" "3fdf3e73-59a3-4518-9521-35f40374d048"
data "TargetEffect" "5d8c64e3-f9ff-4ee0-b0b6-2a081c7244a8"
data "SpellSoundMagnitude" "Small"
data "Sheathing" "Sheathed"
