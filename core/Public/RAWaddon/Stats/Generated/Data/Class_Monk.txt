// Step of the Wind. You can spend 1 ki point to take the Disengage or Dash action as a bonus action on your turn, and your jump distance is doubled for the turn.
new entry "Shout_Dash_StepOfTheWind"
type "SpellData"
using "Shout_Dash_StepOfTheWind"
data "Description" "7bff034e-35d6-47e9-aece-3c2bdb9fcd31;8"

new entry "Shout_Disengage_StepOfTheWind"
type "SpellData"
using "Shout_Disengage_StepOfTheWind"
data "Description" "65031a0a-f3af-428e-8bcd-d041f87c7363;2"

new entry "Shout_PatientDefense"
type "SpellData"
using "Shout_PatientDefense"
data "Description" "a4d2f511-6f9c-4f92-9a27-963427d9a1d3;5"

// ModifyUseCosts is only relevant if RAW default actions and RAW addon Jump are disabled
new entry "STEP_OF_THE_WIND"
type "StatusData"
using "STEP_OF_THE_WIND"
data "Boosts" "JumpMaxDistanceMultiplier(2);UnlockSpellVariant(SpellId('Projectile_Jump'),ModifyUseCosts(Replace,BonusActionPoint,0,0,BonusActionPoint))"

// Immobilized removes Dodge status
// Clean featsextra data as it overlaps with RAW (just visually through)
new entry "DODGE"
type "StatusData"
using "DODGE"
data "Description" "068aecf0-a0cf-4f96-89f7-01e660505685;1"
data "RemoveConditions" "HasStatus('SG_Incapacitated') or Immobilized()"
data "SoundLoop" ""
data "SoundStop" ""
data "StatusEffect" ""

// Returning a deflected missile works only if range is less or equal than 18
// If range is superior than 9, attack will have a disadavantage
new entry "Interrupt_DeflectMissiles"
type "InterruptData"
using "Interrupt_DeflectMissiles"
data "Description" "dd31966a-da1e-40dc-a142-28e6ae45902e;2"

new entry "DeflectMissiles"
type "PassiveData"
using "DeflectMissiles"
data "Boosts" "IF(not HasStatus('SG_Polymorph_BeastShape')):UnlockInterrupt(Interrupt_DeflectMissiles);UnlockInterrupt(Interrupt_DeflectMissiles_Return);UnlockInterrupt(Interrupt_DeflectMissiles_Return_Disadvantage)"

new entry "Interrupt_DeflectMissiles_Return"
type "InterruptData"
using "Interrupt_DeflectMissiles_Return"
data "DisplayName" "a932bee8-bf43-4fa7-bd2e-49554cb6aed3;1"
data "Description" "4bd989ec-ac4e-4c86-81f0-ce21a716945d;2"
data "DescriptionParams" "Distance(6)"
data "Conditions" "DistanceToTargetLesserOrEqualThan(6) and IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and IsAttackType(AttackType.RangedWeaponAttack) and not (IsCriticalMiss() or IsMiss()) and HasActionResource('DeflectMissiles_Charge', 1, 0, false, false, context.Observer) and not AnyEntityIsItem()"
data "Properties" "UseSpell(SWAP,Projectile_Deflect_Missiles,true,true,true,c4598bdb-fc07-40dd-a62c-90cc138bd76f);UseActionResource(OBSERVER_OBSERVER,DeflectMissiles_Charge,1,0)"

new entry "Projectile_Deflect_Missiles"
type "SpellData"
using "Projectile_Deflect_Missiles"
data "Description" "4bd989ec-ac4e-4c86-81f0-ce21a716945d;2"
data "DescriptionParams" "Distance(6)"
data "TargetRadius" "6"

new entry "Interrupt_DeflectMissiles_Return_Disadvantage"
type "InterruptData"
using "Interrupt_DeflectMissiles_Return"
data "DisplayName" "23d44242-1d68-483f-a91b-c22f19dd2db5;1"
data "Description" "2c036a3d-4a50-4f5a-95a3-d295ce610472;2"
data "DescriptionParams" "Distance(18);Distance(6)"
data "Conditions" "DistanceToTargetBetween(6, 18) and IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and IsAttackType(AttackType.RangedWeaponAttack) and not (IsCriticalMiss() or IsMiss()) and HasActionResource('DeflectMissiles_Charge', 1, 0, false, false, context.Observer) and not AnyEntityIsItem()"
data "Properties" "UseSpell(SWAP,Projectile_Deflect_Missiles_Disadvantage,true,true,true,c4598bdb-fc07-40dd-a62c-90cc138bd76f);UseActionResource(OBSERVER_OBSERVER,DeflectMissiles_Charge,1,0)"

new entry "Projectile_Deflect_Missiles_Disadvantage"
type "SpellData"
using "Projectile_Deflect_Missiles"
data "Description" "2c036a3d-4a50-4f5a-95a3-d295ce610472;2"
data "DescriptionParams" "Distance(18);Distance(6)"
data "SpellRoll" "Attack(AttackType.MeleeUnarmedAttack,false,true)"

// Flurry of Blows. Immediately after you take the Attack action on your turn, you can spend 1 ki point to make two unarmed strikes as a bonus action.
new entry "MartialArts_BonusUnarmedStrike"
type "PassiveData"
data "DisplayName" "hfcdc92c3g5dbdg4b16gbf4cg245385dc6bf3;3"
data "Description" "h1a953609ga861g4e08ga260gd3341f5a963e;5"
data "DescriptionParams" "DealDamage(LevelMapValue(MartialArts), Bludgeoning)"
data "Icon" "PassiveFeature_MartialArts_BonusUnarmedStrike"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnAttack;OnCast"
data "Conditions" "IsMeleeAttack() and IsMonkWeaponAttack() and not SpellId('Target_UnarmedStrike_Monk') and not SpellId('Target_FlurryOfBlows_FirstAttack') and not SpellId('Target_FlurryOfBlows_LastAttack')"
data "StatsFunctors" "ApplyStatus(SELF,MARTIAL_ARTS_BONUS_UNARMED_STRIKE,100,1);ApplyStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS,100,1)"

new entry "Target_UnarmedStrike_Monk"
type "SpellData"
using "Target_UnarmedStrike_Monk"
data "SpellProperties" "IF(not Player(context.Source)):ApplyStatus(SELF,AI_HELPER_EXTRAATTACK,100,1);RemoveStatus(SELF,MARTIAL_ARTS_BONUS_UNARMED_STRIKE);RemoveStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS)"

new entry "MARTIAL_ARTS_BONUS_UNARMED_STRIKE"
type "StatusData"
using "MARTIAL_ARTS_BONUS_UNARMED_STRIKE"
data "Boosts" "IF(HasActionResource('BonusActionPoint',1,0,false,false,context.Source)):UnlockSpell(Target_UnarmedStrike_Monk)"

new entry "MARTIAL_ARTS_FLURRY_OF_BLOWS"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h8314a48ag5f5dg464agb684g792054ad643d;2"
data "Description" "h8ed549a4ga454g49b4gb319g7335ccf73b3a;6"
data "Icon" "Action_Monk_FlurryOfBlows"
data "StackId" "MARTIAL_ARTS_FLURRY_OF_BLOWS"
data "TickType" "StartTurn"
data "Boosts" "IF(HasActionResource('BonusActionPoint',1,0,false,false,context.Source) and HasActionResource('KiPoint',1,0,false,false,context.Source)):UnlockSpell(Target_FlurryOfBlows_FirstAttack)"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "MARTIAL_ARTS_FLURRY_OF_BLOWS_LAST_ATTACK"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h8314a48ag5f5dg464agb684g792054ad643d;2"
data "Description" "81821ccc-074c-4184-a1a1-d3a9d165c1cc;6"
data "Icon" "Action_Monk_FlurryOfBlows"
data "StackId" "MARTIAL_ARTS_FLURRY_OF_BLOWS_LAST_ATTACK"
data "TickType" "StartTurn"
data "Boosts" "UnlockSpell(Target_FlurryOfBlows_LastAttack)"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "Target_FlurryOfBlows_FirstAttack"
type "SpellData"
using "Target_FlurryOfBlows"
data "Description" "81821ccc-074c-4184-a1a1-d3a9d165c1cc;6"
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;0579f797-dd8e-408d-b18d-01650f6041e2,,;69345989-e868-432e-9d8c-84f4bcf77494,,;5925204d-590c-4d7c-ac62-a51ba44d4589,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "SpellRoll" "Attack(AttackType.MeleeUnarmedAttack)"
data "SpellSuccess" "DealDamage(UnarmedDamage , Bludgeoning)"
data "TooltipDamageList" "DealDamage(MartialArtsUnarmedDamage, Bludgeoning)"
data "SpellFlags" "IsMelee;IsHarmful;Temporary;DisableBlood"
data "SpellProperties" "RemoveStatus(SELF,MARTIAL_ARTS_BONUS_UNARMED_STRIKE);RemoveStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS);ApplyStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS_LAST_ATTACK,100,1)"

new entry "Target_FlurryOfBlows_LastAttack"
type "SpellData"
using "Target_UnarmedStrike_Monk"
data "DisplayName" "h8314a48ag5f5dg464agb684g792054ad643d;2"
data "Description" "81821ccc-074c-4184-a1a1-d3a9d165c1cc;6"
data "Icon" "Action_Monk_FlurryOfBlows"
data "SpellProperties" "RemoveStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS_LAST_ATTACK)"
data "UseCosts" ""

// Whenever you hit a creature with one of the attacks granted by your Flurry of Blows, you can impose one of the following effects on that target.
new entry "OpenHandTechnique_Passive"
type "PassiveData"
data "DisplayName" "0bf29def-3c66-46c6-af22-37612e0a5f0c;1"
data "Description" "71814ea6-fd14-4c94-a41e-e2735b22b8ec;1"
data "TooltipUseCosts" "KiPoint:1"
data "Icon" "Action_Monk_OpenHandTechnique_Knock"
data "Properties" "Highlighted;IsToggled;ToggledDefaultAddToHotbar"
data "Boosts" "UnlockInterrupt(Interrupt_OpenHandTechnique_Knock);UnlockInterrupt(Interrupt_OpenHandTechnique_Push);UnlockInterrupt(Interrupt_OpenHandTechnique_NoReactions)"

new entry "OpenHandTechnique_Interrupt"
type "InterruptData"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Source,context.Observer) and IsMeleeUnarmedAttack() and not IsMiss() and not AnyEntityIsItem() and not IsKillingBlow() and (IsSpellChildOrVariantFromContext('Target_FlurryOfBlows_FirstAttack') or IsSpellChildOrVariantFromContext('Target_FlurryOfBlows_LastAttack'))"
data "CastTextEvent" "Cast"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

// It must succeed on a Dexterity saving throw or be knocked prone.
new entry "Interrupt_OpenHandTechnique_Knock"
type "InterruptData"
using "OpenHandTechnique_Interrupt"
data "Icon" "Action_Monk_OpenHandTechnique_Knock"
data "DisplayName" "5d781faa-a7de-4575-85de-cf3987b6b99e;2"
data "Description" "00f6f980-a661-4831-abf6-65dd3c0332cf;5"
data "TooltipAttackSave" "Dexterity"
data "TooltipStatusApply" "ApplyStatus(PRONE,100,1)"
data "TargetSound" "Spell_Impact_Monk_OpenHandTech_L1to3"
data "Properties" "IF(not SavingThrow(Ability.Dexterity, WisdomSaveDC())):ApplyStatus(PRONE,100,1)"

// It must make a Strength saving throw. If it fails, you can push it up to 15 feet away from you.
new entry "Interrupt_OpenHandTechnique_Push"
type "InterruptData"
using "OpenHandTechnique_Interrupt"
data "Icon" "Action_Monk_OpenHandTechnique_Push"
data "DisplayName" "2466697e-daab-4ccf-81b9-46041e56b176;2"
data "Description" "e7464e4f-10ca-4234-ac73-494836d2fa9d;5"
data "DescriptionParams" "Distance(4.5)"
data "TooltipAttackSave" "Strength"
data "TargetSound" "Spell_Impact_Monk_OpenHandTech_L1to3"
data "Properties" "IF(not SavingThrow(Ability.Strength, WisdomSaveDC())):ApplyStatus(OPEN_HAND_TECHNIQUE_PUSHED,100,1)"

new entry "OPEN_HAND_TECHNIQUE_PUSHED"
type "StatusData"
data "StatusType" "EFFECT"
data "DisplayName" "0c6234f8-f4bf-420b-8f57-935a65736252;1"
data "OnApplyFunctors" "Force(4.5)"
data "StatusPropertyFlags" "ApplyToDead;AddFallDamageOnLand;DisableOverhead;DisablePortraitIndicator"

// It can't take reactions until the end of your next turn.
new entry "Interrupt_OpenHandTechnique_NoReactions"
type "InterruptData"
using "OpenHandTechnique_Interrupt"
data "Icon" "Action_Monk_OpenHandTechnique_NoReactions"
data "DisplayName" "c0b40fe2-a30b-40f9-8f88-d9209a0e2f2b;2"
data "Description" "922b53c6-37ab-422d-94b1-0ac6aad87ef1;6"
data "TooltipStatusApply" "ApplyStatus(OPEN_HAND_NO_REACTIONS,100,1)"
data "TargetSound" "Spell_Impact_Monk_OpenHandTech_L1to3"
data "Properties" "ApplyStatus(OPEN_HAND_NO_REACTIONS,100,1)"

// Slowfall: reduce any falling damage you take by an amount equal to five times your monk level.
// You land prone unless you avoid taking damage from the fall.
new entry "SlowFall"
type "PassiveData"
using "SlowFall"
data "Description" "2e855c47-a1ef-4444-a028-fc3a1a6ef733;2"
data "EnabledConditions" ""
data "EnabledContext" ""

new entry "SLOWFALL_PASSIVE_TECHNICAL"
type "StatusData"
using "SLOWFALL_PASSIVE_TECHNICAL"
data "Description" "0dd60c74-b15d-4dcf-9884-2ec87dcc7691;2"
data "TickType" ""
data "Boosts" ""
data "RemoveConditions" ""
data "RemoveEvents" ""
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;IgnoreResting"
data "StatusGroups" "SG_RemoveOnRespec"
data "OnRemoveFunctors" ""

//FIXME: StatusImmunity should be conditional if damage taken is 0
new entry "SLOWFALL_TECHNICAL"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h617ec5edg40a2g4fefga310gdee969416e36;1"
data "Description" "0dd60c74-b15d-4dcf-9884-2ec87dcc7691;2"
data "Icon" "Spell_Transmutation_FeatherFall"
data "StackId" "SLOWFALL_TECHNICAL"
//data "Boosts" "DamageReduction(Bludgeoning,Flat,(ClassLevel(Monk)*5));StatusImmunity(SG_Prone)"
data "Boosts" "DamageReduction(Bludgeoning,Flat,(ClassLevel(Monk)*5))"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "OnRemoveFunctors" "UseActionResource(ReactionActionPoint,1)"

// Unarmored Movement: you gain the ability to move along vertical surfaces and across liquids on your turn without falling during the move.
// Maybe add immunity to prone on slowfall ?
new entry "UnarmoredMovement_DifficultTerrain"
type "PassiveData"
using "UnarmoredMovement_DifficultTerrain"
data "Description" "984d9c6f-f6be-4bc6-91af-317da55c5365;7"
data "Boosts" "StatusImmunity(SG_DifficultTerrain)"

// The Aspect of the Crocodile increases your agility in the water.&lt;br&gt;&lt;br&gt;Your &lt;LSTag Tooltip="MovementSpeed"&gt;movement speed&lt;/LSTag&gt; increases by [1] while standing in water-based surfaces.&lt;br&gt;&lt;br&gt;On slippery surfaces, you also have &lt;LSTag Tooltip="Advantage"&gt;Advantage&lt;/LSTag&gt; on &lt;LSTag Tooltip="SavingThrow"&gt;Saving Throws&lt;/LSTag&gt; against being knocked &lt;LSTag Type="Status" Tooltip="PRONE"&gt;Prone&lt;/LSTag&gt;.</content>
// data "BoostConditions" "InSurface('SurfaceAlcohol') or InSurface('SurfaceBlood') or InSurface('SurfaceDeepWater') 
// or InSurface('SurfaceDeepWaterRunning') or InSurface('SurfaceGrease') or InSurface('SurfaceOil') 
// or InSurface('SurfaceWater') or InSurface('SurfaceWaterFrozen') or InSurface('SurfaceBloodFrozen')"
// data "PersonalStatusImmunities" "
// DIFFICULT_TERRAIN_MUD
// PRONE_GREASE
// SG_DifficultTerrain
// data "Boosts" "StatusImmunity(DIFFICULT_TERRAIN);StatusImmunity(PRONE_GREASE);StatusImmunity(PRONE_SEWER);"

// Stunning Strike
new entry "Target_StunningStrike"
type "SpellData"
using "Target_StunningStrike"
data "SpellSuccess" "IF(not SavingThrow(Ability.Constitution, WisdomSaveDC())):ApplyStatus(STUNNED,100,1);DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType); ExecuteWeaponFunctors(MainHand)"

new entry "Target_StunningStrike_Unarmed"
type "SpellData"
using "Target_StunningStrike_Unarmed"
data "SpellSuccess" "IF(not SavingThrow(Ability.Constitution, WisdomSaveDC())):ApplyStatus(STUNNED,100,1);DealDamage(UnarmedDamage, Bludgeoning)"

new entry "StunningStrike_Passive"
type "PassiveData"
data "DisplayName" "ha2b41647g8c02g47c6g9d70g3460189d287c;1"
data "Description" "9e696cef-b886-4c7b-9553-341facdc929b;1"
data "TooltipAttackSave" "MeleeWeaponAttack;Constitution"
data "TooltipUseCosts" "KiPoint:1"
data "Icon" "Action_Monk_StunningStrike"
data "Properties" "Highlighted;IsToggled;ToggledDefaultAddToHotbar"
data "Boosts" "UnlockInterrupt(Interrupt_StunningStrike)"

new entry "Interrupt_StunningStrike"
type "InterruptData"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "InterruptDefaultValue" "Ask;Enabled"
data "Container" "YesNoDecision"
data "DisplayName" "ha2b41647g8c02g47c6g9d70g3460189d287c;1"
data "Description" "9e696cef-b886-4c7b-9553-341facdc929b;1"
data "Icon" "Action_Monk_StunningStrike"
data "Conditions" "not Item() and Self(context.Source,context.Observer) and not Self(context.Source,context.Target) and IsMeleeAttack() and not HasStatus('SG_Stunned',context.Target) and HasDamageEffectFlag(DamageFlags.Hit) and not IsKillingBlow()"
data "Properties" "ApplyStatus(STUNNING_STRIKE,100,1)"
data "Cost" "KiPoint:1"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied"

new entry "STUNNING_STRIKE"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "STUNNING_STRIKE"
data "DisplayName" "h9bb4ea57g5174g47d4g942ag4baa6e2a4c0c;1"
data "Icon" "Status_Stunned"
data "OnApplyFunctors" "IF(not SavingThrow(Ability.Constitution, WisdomSaveDC())):ApplyStatus(STUNNED,100,1)"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

// Wholeness Of Body, keep only the healing part. 
new entry "Shout_WholenessOfBody"
type "SpellData"
using "Shout_WholenessOfBody"
data "SpellProperties" "RegainHitPoints(3*ClassLevel(Monk))"
data "Description" "275e8029-c20c-4625-b628-03fdd1257466;7"
data "TooltipDamageList" "RegainHitPoints(3*ClassLevel(Monk))"
data "TooltipStatusApply" ""
data "UseCosts" "ActionPoint:1"

// Stillness Of Mind, you can use your action to end one effect on yourself that is causing you to be charmed or frightened.
// Autocast if charmed (which would prevent you from using it manually anyway)
// If frightened, you can stil cast it manually if you want to
new entry "StillnessOfMind"
type "PassiveData"
using "StillnessOfMind"
data "DisplayName" "b9839978-40c8-482f-993f-15454c1e3b07;2"
data "Description" "5d129e97-1e4b-44dd-a56a-3f3dd0aa65d4;3"
data "Conditions" "HasStatus('SG_Charmed', context.Source) and HasActionResource('ActionPoint', 1, 0, false, false, context.Source)"
data "StatsFunctors" "RemoveStatus(SG_Charmed);RemoveStatus(SG_Frightened);UseActionResource(SELF,ActionPoint,1,0);UseSpell(SELF,Shout_StillnessOfMind,true,true,true)"

new entry "Shout_StillnessOfMind"
type "SpellData"
using "Shout_StillnessOfMind"
data "Conditions" "HasStatus('SG_Charmed', context.Source) or HasStatus('SG_Frightened', context.Source)"

// Tranquility lasts until long rest
new entry "Tranquility"
type "PassiveData"
using "Tranquility"
data "StatsFunctors" "ApplyStatus(SELF,SANCTUARY_TRANQUILITY,100,-1)"

// Lesser Quivering Palm
new entry "KiResonation_Passive"
type "PassiveData"
data "Icon" "Action_KiResonation_Punch"
data "DisplayName" "20e0049c-c134-46d5-afd4-f7f3685bf794;2"
data "Description" "d13b42e1-0793-40eb-8e47-49e12b60baef;3"
data "DescriptionParams" "2"
data "ExtraDescription" ""
data "TooltipUseCosts" "KiPoint:2"
data "Properties" "Highlighted;IsToggled;ToggledDefaultAddToHotbar"
data "Boosts" "UnlockInterrupt(Interrupt_KiResonation)"

new entry "Interrupt_KiResonation"
type "InterruptData"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "InterruptDefaultValu&e" "Ask;Enabled"
data "Container" "YesNoDecision"
data "DisplayName" "bcf9b273-5e86-436b-94f4-b539e6495c67;2"
data "Description" "7789c49d-d9b0-4fd2-a88a-92055e539ef9;3"
data "TooltipStatusApply" "ApplyStatus(KI_RESONATION, 100, -1)"
data "TooltipUseCosts" "KiPoint:2"
data "Icon" "Action_KiResonation_Punch"
data "Conditions" "not Item() and Self(context.Source,context.Observer) and not Self(context.Source,context.Target) and IsMeleeAttack() and IsUnarmedAttack() and not HasStatus('KI_RESONATION') and HasDamageEffectFlag(DamageFlags.Hit) and not IsKillingBlow()"
//data "Properties" "UseSpell(OBSERVER_TARGET,Target_KiResonation_Punch,true,true,true)"
data "Properties" "ApplyStatus(KI_RESONATION, 100, -1)
data "Cost" "KiPoint:2"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "Target_KiResonation_Punch"
type "SpellData"
using "Target_KiResonation_Punch"
data "SpellSuccess" "ApplyStatus(KI_RESONATION, 100, -1)"
data "Description" "7789c49d-d9b0-4fd2-a88a-92055e539ef9;3"
data "TooltipStatusApply" "ApplyStatus(KI_RESONATION, 100, -1)"

new entry "Target_KiResonation_Blast"
type "SpellData"
using "Target_KiResonation_Blast"
data "Cooldown" ""
data "SpellProperties" "RemoveStatus(KI_RESONATION)"
data "SpellRoll" "not SavingThrow(Ability.Constitution, WisdomSaveDC())"
data "SpellSuccess" "DealDamage(5d10, Necrotic, Magical)" 
data "SpellFail" "DealDamage((5d10)/2, Necrotic, Magical)"
data "TargetRadius" "18"
data "AreaRadius" "0"
data "DisplayName" "8d1c4c37-d27f-4949-90b5-dbeff5f9a93e;1"
data "Description" "156f3e5d-81fd-4447-8bcc-33da80252072;3"
data "DescriptionParams" "5d10"
data "ExtraDescription" ""
data "TooltipDamageList" "DealDamage(5d10, Necrotic)"
data "TooltipAttackSave" "Constitution"
data "UseCosts" "ActionPoint:1"
data "SpellFlags" "IsHarmful"
data "DamageType" "Necrotic"

new entry "KI_RESONATION"
type "StatusData"
using "KI_RESONATION"
data "DisplayName" "hf3a73818g3b39g454dgb194g9d186c0c6423;3"
data "Description" "c516018a-0e11-4554-a3fd-a26c6bcd4c96;3"
data "OnRemoveFunctors" ""

// Four Elements passive
new entry "FourElementsDisciplines"
type "PassiveData"
data "Properties" "IsHidden"
data "Boosts" "UnlockInterrupt(Interrupt_FangsOfTheFireSnake)"

// Fangs Of The Fire Snake
new entry "Projectile_FangsOfTheFireSnake"
type "SpellData"
using "Projectile_FangsOfTheFireSnake"
data "SpellProperties" "IF(not Player(context.Source)):ApplyStatus(SELF,AI_HELPER_EXTRAATTACK,100,1);ApplyStatus(SELF,FANGS_OF_THE_FIRE_SNAKE,100,1);ApplyStatus(SELF,MARTIAL_ARTS_BONUS_UNARMED_STRIKE,100,1);ApplyStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS,100,1)"
data "TargetRadius" "4.5"
data "SpellRoll" "Attack(AttackType.MeleeUnarmedAttack)	"
data "SpellSuccess" "DealDamage(UnarmedDamage, Fire)"
data "Description" "f316aa7c-6e93-4b99-ae71-83e3c67f9b0a;6"
data "TooltipDamageList" "DealDamage(MartialArtsUnarmedDamage, Fire)"
data "TooltipAttackSave" "MeleeUnarmedAttack"
data "TooltipStatusApply" "ApplyStatus(FANGS_OF_THE_FIRE_SNAKE,100,1); "

new entry "FANGS_OF_THE_FIRE_SNAKE"
type "StatusData"
using "FANGS_OF_THE_FIRE_SNAKE"
data "DisplayName" "h60dd4652gfc75g4a9dg8256gbc9bbeb1395b;1"
data "Description" "f316aa7c-6e93-4b99-ae71-83e3c67f9b0a;6"
data "Boosts" "UnlockSpellVariant(MeleeUnarmedAttackCheck(),ModifyTargetRadius(Override,4.5))"
data "StatusEffect" "9c1c9ea9-e5d5-4f1e-91f2-415f5e80e942"

new entry "Interrupt_FangsOfTheFireSnake"
type "InterruptData"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "InterruptDefaultValue" "Ask;Enabled"
data "InterruptDefaultValue" ""
data "Container" "YesNoDecision"
data "DisplayName" "h60dd4652gfc75g4a9dg8256gbc9bbeb1395b;1"
data "Description" "f368060b-4738-4353-b142-a9aa16257a39;1"
data "Icon" "Action_Monk_FangsOfTheFireSnake"
data "Conditions" "not Item() and Self(context.Source,context.Observer) and not Self(context.Source,context.Target) and HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source) and IsMeleeUnarmedAttack() and HasDamageEffectFlag(DamageFlags.Hit) and not IsKillingBlow()"
data "Properties" "DealDamage(1d10,Fire)"
data "Cost" "KiPoint:1"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied"

new entry "Target_UnarmedAttack"
type "SpellData"
using "Target_UnarmedAttack"
data "SpellSuccess" "IF(not HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Bludgeoning);IF(HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Fire)"

new entry "Target_UnarmedStrike_Monk"
type "SpellData"
using "Target_UnarmedStrike_Monk"
data "SpellSuccess" "IF(not HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Bludgeoning);IF(HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Fire)"

new entry "Target_FlurryOfBlows_FirstAttack"
type "SpellData"
using "Target_FlurryOfBlows_FirstAttack"
data "SpellSuccess" "IF(not HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Bludgeoning);IF(HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Fire)"

new entry "Target_FlurryOfBlows_LastAttack"
type "SpellData"
using "Target_FlurryOfBlows_LastAttack"
data "SpellSuccess" "IF(not HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Bludgeoning);IF(HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Fire)"

new entry "Projectile_Deflect_Missiles"
type "SpellData"
using "Projectile_Deflect_Missiles"
data "SpellSuccess" "IF(not HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Bludgeoning);IF(HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Fire)"

new entry "Projectile_Deflect_Missiles_Disadvantage"
type "SpellData"
using "Projectile_Deflect_Missiles_Disadvantage"
data "SpellSuccess" "IF(not HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Bludgeoning);IF(HasStatus('FANGS_OF_THE_FIRE_SNAKE',context.Source)):DealDamage(UnarmedDamage, Fire)"

// Fist of Four Thunders
new entry "RAW_FistOfFourThunders"
type "SpellData"
data "SpellType" "Zone"
data "ContainerSpells" "Zone_Thunderwave_Monk_3;Zone_Thunderwave_Monk_2;Zone_Thunderwave_Monk"
data "Icon" "Spell_Evocation_Thunderwave"
data "DisplayName" "hd3e28c15gfb0fg42d1g98e1gf65e6d78ce6a;2"
data "Description" "h1780b369gb2c3g4bbagb0c5ga163962737e3;2"
data "TooltipDamageList" "DealDamage(2d8,Thunder)"
data "TooltipAttackSave" "Constitution"
data "TooltipOnSave" "f762efbb-f8f1-493e-b248-2de1567b4bd2"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1;KiPoint:2"
data "SpellFlags" "HasSomaticComponent;AddFallDamageOnLand;IsHarmful;IsLinkedSpellContainer"

new entry "Zone_Thunderwave_Monk"
type "SpellData"
using "Zone_Thunderwave_Monk"
data "SpellRoll" "not SavingThrow(Ability.Constitution, WisdomSaveDC())"
data "SpellSuccess" "DealDamage(2d8,Thunder,Magical);Force(3, OriginToTarget)"
data "SpellFail" "DealDamage((2d8)/2,Thunder,Magical);"
data "TooltipDamageList" "DealDamage(2d8,Thunder)"
data "UseCosts" "ActionPoint:1;KiPoint:2"
data "SpellContainerID" "RAW_FistOfFourThunders"

new entry "Zone_Thunderwave_Monk_2"
type "SpellData"
using "Zone_Thunderwave_Monk"
data "SpellSuccess" "DealDamage(3d8,Thunder,Magical);Force(3, OriginToTarget)"
data "SpellFail" "DealDamage((3d8)/2,Thunder,Magical);"
data "TooltipDamageList" "DealDamage(3d8,Thunder)"
data "UseCosts" "ActionPoint:1;KiPoint:3"
data "SpellContainerID" "RAW_FistOfFourThunders"
data "RequirementConditions" "ClassLevelHigherOrEqualThan(5,'Monk')"

new entry "Zone_Thunderwave_Monk_3"
type "SpellData"
using "Zone_Thunderwave_Monk"
data "SpellSuccess" "DealDamage(4d8,Thunder,Magical);Force(3, OriginToTarget)"
data "SpellFail" "DealDamage((4d8)/2,Thunder,Magical);"
data "TooltipDamageList" "DealDamage(4d8,Thunder)"
data "UseCosts" "ActionPoint:1;KiPoint:4"
data "SpellContainerID" "RAW_FistOfFourThunders"
data "RequirementConditions" "ClassLevelHigherOrEqualThan(9,'Monk')"

// Fist Of Unbroken Air
new entry "RAW_FistOfUnbrokenAir"
type "SpellData"
data "SpellType" "Zone"
data "ContainerSpells" "Target_FistOfUnbrokenAir_3;Target_FistOfUnbrokenAir_2;Target_FistOfUnbrokenAir"
data "Icon" "Action_Monk_FistOfUnbrokenAir"
data "DisplayName" "h133847b1gabedg4325gae61g968ab733a058;2"
data "Description" "hb580f508g6b4cg463ega722g7b92469c17e5;7"
data "TooltipDamageList" "DealDamage(3d10,Bludgeoning)"
data "TooltipAttackSave" "Strength"
data "TooltipOnSave" "f762efbb-f8f1-493e-b248-2de1567b4bd2"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1;KiPoint:2"
data "SpellFlags" "DisableBlood;AddFallDamageOnLand;IsHarmful;IsLinkedSpellContainer"

new entry "Target_FistOfUnbrokenAir"
type "SpellData"
using "Target_FistOfUnbrokenAir"
data "SpellProperties" "ApplyStatus(SELF,MARTIAL_ARTS_BONUS_UNARMED_STRIKE,100,1);ApplyStatus(SELF,MARTIAL_ARTS_FLURRY_OF_BLOWS,100,1)"
data "SpellRoll" "not SavingThrow(Ability.Strength, WisdomSaveDC())"
data "SpellSuccess" "DealDamage(3d10,Bludgeoning);Force(6);ApplyStatus(PRONE,100,1)"
data "SpellFail" "DealDamage((3d10)/2,Bludgeoning)"
data "TooltipDamageList" "DealDamage(3d10,Bludgeoning)"
data "SpellContainerID" "RAW_FistOfUnbrokenAir"

new entry "Target_FistOfUnbrokenAir_2"
type "SpellData"
using "Target_FistOfUnbrokenAir"
data "SpellSuccess" "DealDamage(4d10,Bludgeoning);Force(6);ApplyStatus(PRONE,100,1)"
data "SpellFail" "DealDamage((4d10)/2,Bludgeoning)"
data "TooltipDamageList" "DealDamage(4d10,Bludgeoning)"
data "UseCosts" "ActionPoint:1;KiPoint:3"
data "SpellContainerID" "RAW_FistOfUnbrokenAir"
data "RequirementConditions" "ClassLevelHigherOrEqualThan(5,'Monk')"

new entry "Target_FistOfUnbrokenAir_3"
type "SpellData"
using "Target_FistOfUnbrokenAir"
data "SpellSuccess" "DealDamage(5d10,Bludgeoning);Force(6);ApplyStatus(PRONE,100,1)"
data "SpellFail" "DealDamage((5d10)/2,Bludgeoning)"
data "TooltipDamageList" "DealDamage(5d10,Bludgeoning)"
data "UseCosts" "ActionPoint:1;KiPoint:4"
data "SpellContainerID" "RAW_FistOfUnbrokenAir"
data "RequirementConditions" "ClassLevelHigherOrEqualThan(9,'Monk')"

// Sweeping Cinder Strike
// -> Zone_BurningHands_Monk
new entry "Zone_BurningHands_Monk"
type "SpellData"
using "Zone_BurningHands_Monk"
data "SpellProperties" "GROUND:SurfaceChange(Ignite);GROUND:SurfaceChange(Melt);TARGET:IF(Item()):ApplyStatus(BURNING,100,2);ApplyStatus(SELF,MARTIAL_ARTS_BONUS_UNARMED_STRIKE,100,1)"
data "SpellSuccess" "DealDamage(LevelMapValue(BurningHands_Monk), Fire,Magical)"
data "SpellFail" "DealDamage(LevelMapValue(BurningHands_Monk)/2, Fire,Magical)"
data "DisplayName" "hf3c69a0agc6b0g4e79g9d03g856f0f56dca5;2"
data "Description" "hedc3040eg8cd8g4a32g97c2g65d5e5c6c33d;1"
data "TooltipDamageList" "DealDamage(LevelMapValue(BurningHands_Monk),Fire)"
data "PrepareSound" "Vocal_Component_Monk_Damage"
data "CastSound" "Spell_Cast_Monk_SweepingCinderStrike_L1to3"
data "TargetSound" "Spell_Impact_Monk_SweepingCinderStrike_L1to3"
data "VocalComponentSound" "Vocal_Component_Stop"
data "UseCosts" "ActionPoint:1;KiPoint:2"
data "SpellAnimation" "ba181bb4-331a-4e69-92af-d09bde86d835,,;,,;2c5aae21-74b6-452d-9d76-53d4c36e5ba2,,;4c923700-3192-4c7c-8009-26e1087fa91e,,;a1c2c833-b2c8-465f-a902-b6ae38f6553d,,;,,;74dead2e-d842-4d29-976a-d1cb373f7f0e,,;,,;,,"
data "SpellStyleGroup" "Class"
data "SpellFlags" "HasSomaticComponent;IsHarmful;CanAreaDamageEvade"
data "PowerLevel" ""
data "PrepareEffect" "8e955204-7c26-4ac8-8595-94f87b25ac71"
data "CastEffect" "5aac9d6e-ca02-40d3-a59c-e1d0fc6af5c8"
data "TargetEffect" "53412dd1-8066-4860-a2ae-b27e77bfdab5"


// Rush of the Gale Spirits
// -> Zone_GustOfWind_Monk


// Shape the Flowing River
// -> Target_ShapeTheFlowingRiver_IceBlock


// Water Whip
// -> Target_WaterWhip


// Clench of the North Wind
// -> Target_HoldPerson_Monk


// Gong of the Summit
// -> Target_Shatter_Monk


// Flames of the Phoenix
// -> Projectile_Fireball_Monk


// Mist Stance
// -> Shout_GaseousForm_Monk


// Ride the Wind
// -> Shout_Fly_Monk
